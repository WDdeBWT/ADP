function subctf(){$.post(base_url+"racing/checklogin",{type:1},function(a){if(a>0){var i=$("#answerstr").val(),s=$("#coursescoreid").val();""!=i?""!=s?$.post(base_url+"racing/submit",{coursescoreid:s,answerstr:i},function(a){a?1==a.state?($(".zqcw").empty().append('<span class="zq">回答正确</span>'),$(".answer").empty().append("<span>已解答</span>"),setTimeout(function(){window.location.reload()},3e3)):$(".zqcw").empty().append('<span class="cw">回答错误</span>'):$(".zqcw").empty().append('<span class="cw">提交失败</span>')},"json"):FailureDialog("参数错误"):FailureDialog("答案不能为空")}else ForceLoginDialogPage()})}function applytiaozhan(a){var i=$(a).attr("item"),s="";if(i>0){if(applytiaozhan.ajax instanceof Object&&4!=applytiaozhan.ajax.readyState)return void FailureDialog("请不要重复申请实验",null);if(applytiaozhan.cid=0,applytiaozhan.ajax=$.ajax({url:base_url+"racing/islock",type:"POST",dataType:"json",data:{item:i},async:!1,success:function(a){1==a.state?applytiaozhan.cid=resTask.NormalApplyScene(i,null,2):3==a.state?FailureDialog(a.message):ForceLoginDialogPage()},error:function(a){FailureDialog("加载失败")}}),applytiaozhan.cid){s=window.open(exam_url+"vm/"+applytiaozhan.cid+"/1","vm");try{s.focus()}catch(a){}}}}function racinglogin(a){$.post(base_url+"racing/checklogin",{type:1},function(i){0==i?ForceLoginDialogPage():window.location.href=a})}$(function(){function a(){var a=$(".ma_con").height()/2;$(".ma_con").css({"margin-top":-a})}$(".waterfall dl").hover(function(){that=this;var a=$(this).find("p.xbb").height();return!(a<=0)&&($(this).find("p.xbb").css({height:a}),$(this).css({"margin-bottom":-a+"px"}),$(that).find("p.xbb").stop(!1,!0).slideDown(),void $(that).addClass("hov").siblings().removeClass("hov"))},function(){$(this).find("p.xbb").slideUp(),$(this).removeClass("hov"),$(this).find(".xbb").css({display:"none"}),$(this).css({"margin-bottom":"26px"}),$(this).find("p.xbb").stop(!1,!0)}),$(".divone").each(function(a){var i=$(this).find("dl").length,s=$(this).parent(".waterfall").children(".divtwo").find("dl").length;s>0?$(".load").eq(a).css({display:"block"}):$(".load").eq(a).css({display:"none"}),i>=3&&$(".divone").eq(a).css({height:"780px"})}),$(".load").each(function(a){$(".divone").eq(a).find("dl:odd").css("margin-right","0px"),$(".divtwo").eq(a).find("dl:odd").css("margin-right","0px");var i=$(".divtwo").eq(a).find("dl").length;$(".divtwo").eq(a).css({height:390*Math.ceil(i/2)+"px"}),$(this).click(function(){$(this).css({display:"none"}),$(this).toggleClass("uphh");for(var a=$(".divtwo").length,i=0;i<a;i++)$(".divtwo").eq(i).find("dl:odd").css("margin-right","0px");for(var i=0;i<a;i++)$(".divone").eq(i).find("dl:odd").css("margin-right","0px");$(this).prev("div.waterfall").find("div.divtwo").slideToggle()})}),$(".waterfall").on("click",".cryptography",function(){var i=$(this);$.post(base_url+"racing/checklogin",{type:1},function(s){if(s>0){var e=i.attr("item");$.post(base_url+"racing/tanctf",{coursescoreid:e},function(i){if(i&&1==i.state){var s="";if(i.paiming.length>0)for(var e=0;e<i.paiming.length;e++)s+="<span>"+i.paiming[e].RealName+"</span>";else s="暂无排名";var n="未解答";1==i.isAnswer&&(n="<span>已解答</span>");var t="";t+='<div class="ceng"></div><div class="ma_con"><h3 class="nx">'+i.Question.barrier+'<span class="clos"></span></h3><div class="check_con"><p class="one_pai"><span class="fraction">分值：<span>'+i.Score+'</span>分</span> <span class="type">类型：<span>'+i.Category+'</span></span><span class="answer">'+n+'</span></p><div class="ti_mu"><p class="timuss">题目：</p><div class="questiontxt">'+i.Question.describe.content+'</div></div><input type="hidden" value="'+i.CourseScoreID+'" name="coursescoreid" id="coursescoreid"><p class="srk"><span>Flag：</span><input type="text" name="answerstr" id="answerstr" value="" /> <button onclick="subctf()">提交</button> </p><p class="zqcw"></p><p class="topic">解题排名：'+s+"</p></div></div>",$(".mask").empty().append(t).fadeIn(500),a(),$(".mask .clos").on("click",function(){$(".mask").fadeOut(400)})}},"json")}else ForceLoginDialogPage()})});var i;$(".subhk").on("click",function(){$.post(base_url+"racing/checklogin",{type:1},function(a){if(a>0){var s=$("#answerstr").val(),e=$("#coursescoreid").val();if(""!=s)if(""!=e){if(null!=i&&"pending"===i.state())return!1;i=$.post(base_url+"racing/submit",{coursescoreid:e,answerstr:s},function(a){a?1==a.state?1==a.over?dialog({title:"比赛完成",content:"恭喜您已通过“2016年黑客比赛”全部关卡<br>您将获得"+a.total+"积分",titcenter:!0,btntxt:"知道了",callack:function(){window.location.reload()}}):(SucceedDialog(a.message),setTimeout("window.location.href='"+base_url+"racing/"+a.courseid+"/"+a.coursescoreid+"'",3e3)):FailureDialog(a.message):FailureDialog("提交失败")},"json")}else FailureDialog("参数错误");else FailureDialog("答案不能为空")}else ForceLoginDialogPage()})});var s;return $(".waterfall").on("click",".gz",function(){if(null!=s&&"pending"===s.state())return!1;var a=$(this),i=a.attr("item");s=$.post(base_url+"racing/favorite",{courseid:i},function(i){i?1==i.state?(SucceedDialog(i.message),1==i.IsDeleted?a.parent("dt").parent("dl").removeClass("ygz"):a.parent("dt").parent("dl").addClass("ygz")):2==i.state?ForceLoginDialogPage():FailureDialog(i.message):FailureDialog("关注失败")},"json")}),!($(".ti_mu p img").length>0)||void $("a[rel]").foxibox()});